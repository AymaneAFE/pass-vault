### Auth Service API Tests
### Base URL: http://localhost:8081

@baseUrl = http://localhost:8081/api/auth

### ============================================
### 1. REGISTER - Create a new user account
### ============================================
POST {{baseUrl}}/register
Content-Type: application/json

{
  "username": "testuser",
  "email": "testuser@example.com",
  "password": "SecurePass123!"
}

> {%
    client.global.set("accessToken", response.body.accessToken);
    client.global.set("refreshToken", response.body.refreshToken);
%}


### ============================================
### 2. LOGIN - Authenticate and get JWT tokens
### ============================================
POST {{baseUrl}}/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "SecurePass123!"
}

> {%
    client.global.set("accessToken", response.body.accessToken);
    client.global.set("refreshToken", response.body.refreshToken);
%}


### ============================================
### 3. VALIDATE TOKEN - Check if token is valid
### ============================================
GET {{baseUrl}}/validate
Authorization: Bearer {{accessToken}}


### ============================================
### 4. REFRESH TOKEN - Get new access token
### ============================================
POST {{baseUrl}}/refresh
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

> {%
    client.global.set("accessToken", response.body.accessToken);
%}


### ============================================
### 5. LOGOUT - Invalidate session/tokens
### ============================================
POST {{baseUrl}}/logout
Authorization: Bearer {{accessToken}}


### ============================================
### Additional Test Cases
### ============================================

### Register with invalid email
POST {{baseUrl}}/register
Content-Type: application/json

{
  "username": "newuser",
  "email": "invalid-email",
  "password": "SecurePass123!"
}


### Register with short password (should fail)
POST {{baseUrl}}/register
Content-Type: application/json

{
  "username": "newuser2",
  "email": "newuser2@example.com",
  "password": "short"
}


### Login with wrong credentials (should fail)
POST {{baseUrl}}/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "WrongPassword!"
}


### Validate without token (should fail or return invalid)
GET {{baseUrl}}/validate


### Validate with invalid token
GET {{baseUrl}}/validate
Authorization: Bearer invalid.token.here


### ============================================
### Health Check (Actuator)
### ============================================
GET http://localhost:8081/actuator/health
